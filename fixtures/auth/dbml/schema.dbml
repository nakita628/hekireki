Enum UserRole {
  ADMIN
  USER
}

Table User {
  id String [pk, note: 'Unique user ID']
  name String [note: 'Display name']
  email String [unique, note: 'Email address']
  emailVerified DateTime [note: 'Date when the email was verified']
  image String [note: 'Profile image URL']
  password String [note: 'Hashed password']
  role UserRole [default: 'USER', not null, note: 'Role of the user (ADMIN or USER)']
  accounts Account [not null, note: 'Linked accounts']
  isTwoFactorEnabled Boolean [default: false, note: 'Whether 2FA is enabled']
  twoFactorConfirmation TwoFactorConfirmation [note: '2FA confirmation']
}

Table Account {
  id String [pk, note: 'Unique account ID']
  userId String [not null, note: 'Reference to the user ID']
  type String [not null, note: 'Type of account (e.g., oauth, email)']
  provider String [not null, note: 'Name of the provider (e.g., google, github)']
  providerAccountId String [not null, note: 'Provider-specific account ID']
  refresh_token String [note: 'Refresh token']
  access_token String [note: 'Access token']
  expires_at Int [note: 'Expiration time (UNIX timestamp)']
  token_type String [note: 'Token type (e.g., Bearer)']
  scope String [note: 'OAuth scope']
  id_token String [note: 'ID token']
  session_state String [note: 'Session state']
  user User [not null, note: 'Belongs to user']

  indexes {
    (provider, providerAccountId) [unique]
  }
}

Table VerificationToken {
  id String [pk, note: 'Token ID']
  email String [not null, note: 'Email address']
  token String [unique, not null, note: 'Token string']
  expires DateTime [not null, note: 'Expiry time']

  indexes {
    (email, token) [unique]
  }

  Note: 'Email verification token'
}

Table PasswordResetToken {
  id String [pk, note: 'Token ID']
  email String [not null, note: 'Email address']
  token String [unique, not null, note: 'Token string']
  expires DateTime [not null, note: 'Expiry time']

  indexes {
    (email, token) [unique]
  }

  Note: 'Password reset token'
}

Table TwoFactorToken {
  id String [pk, note: 'Token ID']
  email String [not null, note: 'Email address']
  token String [unique, not null, note: 'Token string']
  expires DateTime [not null, note: 'Expiry time']

  indexes {
    (email, token) [unique]
  }
}

Table TwoFactorConfirmation {
  id String [pk, note: 'Confirmation ID']
  userId String [unique, not null, note: 'Reference to user']
  user User [not null, note: 'The user who confirmed 2FA']
}

Ref Account_userId_fk: Account.userId > User.id [delete: Cascade]

Ref TwoFactorConfirmation_userId_fk: TwoFactorConfirmation.userId - User.id [delete: Cascade]